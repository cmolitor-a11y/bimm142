---
title: "Class 09: Structural Bioinformatics (pt1)"
author: "Charlize Molitor (PID: A18515740)"
format: pdf
toc: TRUE
---
## the PDB database

The main database for structural biology is called the PDB. Let's have a look at what it contains:

Download a CSV file from the PDB site (accessible from “Analyze” > “PDB Statistics” > “by Experimental Method and Molecular Type”.

```{r}
stats <- read.csv("Data Export Summary.csv")
stats
```
```{r}
stats$Total
```
Oh, these are characters not numeric...

```{r}
as.numeric(sub(",", "", stats$Total))
```

```{r pdbstats, message=FALSE}
library(readr)


stats <- read_csv("Data Export Summary.csv")
stats
```

```{r}
n.total <- sum(stats$Total)
n.total
```

> Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy. Give your answer to 2 significant figures 

```{r}
n.xray <- sum(stats$`X-ray`)
percent.xray <- n.xray / n.total * 100
percent.xray
```

There are `r round(percent.xray,2)` percent Xray structures in the PDB

```{r}
n.em <-sum(stats $ `EM`)
percent.em <- n.em / n.total * 100
percent.em 
```

There are `r round(percent.em,2)`, percent EM structures in the PDB

> Q2: What proportion of structures in the PDB are protein?

```{r}
round(stats$Total[1]/n.total * 100, 2)
```


## Exploring PDB structures

Package for structural bioinformatics 

```{r}
library(bio3d)

hiv <- read.pdb("1hsg")
hiv
```


Let's first use the Mol* viewer to explore this structure.

![My first view of HIV-Pr](1HSG.png)

And a view of the ligand (ball and stick) with catalytic ASP 25 amino acids(spacefill) and all the important active site water molecule (spacefill)

![](1HSG-2.png)




## PDB object in R

```{r}
head(hiv$atom)
```

Extract the sequence 
```{r}
pdbseq(hiv)
```


```{r}
chainA_seq <- pdbseq(trim.pdb(hiv, chain = "A"))
```

I can interatively view these PDB objects in R with the new **bio3dview** package. This is not on CRAN yet

To install this I can setup **pak** package and use it to install **bio3dview** from GitHub. In my console I first run **install.packages("pak")**, then I run **pak::pak("bioboot/bio3dview")** and **install.packages("NGLVieweR")**

```{r}
library(bio3dview)

view.pdb(hiv)
```

Change some settings

```{r}
sel <- atom.select(hiv, resno=25)

view.pdb(hiv, highlight = sel,highlight.style= "spacefill", colorScheme = "chain", col = c("blue", "orange"), backgroundColor = "pink")
```

## Predict protein flexibility

We can run a bioinformatics calculation to predict protein dynamics- i.e. functional motions.
We will use the `nma()` function:

```{r}
adk <- read.pdb("6s36")
adk
```

```{r}
m <- nma(adk)
plot(m)
```

Generate a "trajectory" of predicted motion
```{r}
mktrj(m, file ="ADK_nma.pdb")
```

```{r}
view.nma(m)
```

